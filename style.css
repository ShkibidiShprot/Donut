:root {
  --cork: #d3b38d;
  --paper: #f8f1dd;
  --sticky: #f7e28f;
  --thread: #c8433a;
  --ink: #2c2c2c;
}

* { box-sizing: border-box; margin: 0; padding: 0; }

html, body {
  width: 100%;
  height: 100%;
  overflow: hidden;
  position: fixed;
  background: #222;
  font-family: -apple-system, BlinkMacSystemFont, sans-serif;
  color: var(--ink);
  overscroll-behavior: none;
  -webkit-tap-highlight-color: transparent;
}

.workspace {
  position: relative;
  width: 100vw;
  height: 100vh;
  background: #1a1a1a;
  overflow: hidden;
}

.hud {
  position: fixed;
  top: 16px;
  left: 16px;
  background: rgba(255,255,255,.95);
  border-radius: 10px;
  padding: 8px 14px;
  box-shadow: 0 4px 12px rgba(0,0,0,.3);
  z-index: 100;
}

.badge {
  display: flex;
  align-items: center;
  gap: 6px;
  background: #ffecd1;
  padding: 4px 10px;
  border-radius: 99px;
  color: #8b5e34;
  font-weight: 700;
  font-size: 12px;
}

.badge span {
  width: 8px;
  height: 8px;
  background: var(--thread);
  border-radius: 50%;
}

.hud-text { font-size: 10px; color: #666; margin-top: 4px; }

.board {
  position: absolute;
  left: 0;
  top: 0;
  width: 2600px;
  height: 1600px;
  background-color: var(--cork);
  background-image: radial-gradient(rgba(0,0,0,.08) 2px, transparent 2px);
  background-size: 30px 30px;
  border: 12px solid #8d6e53;
  border-radius: 16px;
  box-shadow: inset 0 0 30px rgba(0,0,0,.2);
  transform-origin: 0 0;
  touch-action: none;
  cursor: grab;
  contain: layout style paint;
}

.board.dragging { cursor: grabbing; }

.item {
  position: absolute;
  padding: 16px 20px;
  border-radius: 2px;
  color: var(--ink);
  box-shadow: 2px 3px 6px rgba(0,0,0,.1);
  transform: rotate(var(--r, 0deg));
  -webkit-user-select: none;
  user-select: none;
  cursor: pointer;
  background: var(--paper);
  content-visibility: auto;
  contain-intrinsic-size: 200px 200px;
}

.item.offscreen {
  visibility: hidden;
  pointer-events: none;
}

.item:active { transform: rotate(var(--r, 0deg)) scale(1.02); z-index: 50; }
.item.active { transform: rotate(var(--r, 0deg)) scale(1.03); z-index: 100; box-shadow: 0 12px 30px rgba(0,0,0,.3); }

.hw { font-family: 'Caveat', cursive; font-size: 18px; line-height: 1.3; }
.mono { font-family: monospace; }
.paper { background: #fdf6e3; }
.sticky { background: #fff0a5; }
.sticky.blue { background: #e0f2fe; }
.sticky.pink { background: #ffc2d1; }
.sticky.white { background: #fff; }
.sticky.dark { background: #333; color: #0f0; }
.dark-bg { background: #222; color: #fff; }

.lg { font-size: 22px; }
.xl { font-size: 32px; }
.sm { font-size: 14px; }
.xs { font-size: 11px; }
.bold { font-weight: 700; }
.gray { color: #666; }
.red { color: #991b1b; }
.purple { color: #8a2be2; }
.center { text-align: center; }

.border-b { border-bottom: 1px solid #ccc; margin-bottom: 8px; padding-bottom: 4px; }
.border-b2 { border-bottom: 2px solid #000; margin-bottom: 8px; padding-bottom: 4px; }

.polaroid { background: #fff; padding: 12px 12px 20px; }
.frame { width: 100%; height: 160px; background: #eee; margin-bottom: 10px; box-shadow: inset 0 0 10px rgba(0,0,0,.08); }
.frame.orange { background: #fed7aa; }
.frame.yellow { background: #fef3c7; }

.pin {
  position: absolute;
  width: 12px;
  height: 12px;
  background: #e74c3c;
  border-radius: 50%;
  top: -0px;
  left: calc(50% - 6px);
  box-shadow: 1px 2px 3px rgba(0,0,0,.25);
  z-index: 2;
}

.pin.blue { background: radial-gradient(circle at 30% 30%, #60a5fa, #2563eb); }
.pin.brown { background: radial-gradient(circle at 30% 30%, #a87c5a, #6b4423); }
.pin.silver { background: radial-gradient(circle at 30% 30%, #e5e5e5, #888); }
.center-pin { left: calc(50% - 6px); top: 0; }

.tape {
  position: absolute;
  top: -10px;
  left: 35%;
  width: 60px;
  height: 18px;
  background: rgba(255,255,255,.4);
  transform: rotate(-3deg);
  box-shadow: 0 1px 2px rgba(0,0,0,.08);
}

.tape.light { background: rgba(255,255,255,.2); }
.tape.deco { position: absolute; }

.strings { position: absolute; inset: 0; pointer-events: none; z-index: 0; }
.strings line { stroke: var(--thread); stroke-width: 2px; stroke-dasharray: 5 5; opacity: .7; }

.bg-text {
  position: absolute;
  font-family: 'Caveat', cursive;
  color: rgba(60,40,20,.2);
  font-size: 20px;
  pointer-events: none;
}

.st-paw, .st-star, .st-heart {
  position: absolute;
  width: 24px;
  height: 24px;
  pointer-events: none;
}

.st-paw { background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="%23a18cd1"><path d="M12 2C13.1 2 14 2.9 14 4S13.1 6 12 6 10 5.1 10 4 10.9 2 12 2M17 5C18.1 5 19 5.9 19 7S18.1 9 17 9 15 8.1 15 7 15.9 5 17 5M7 5C8.1 5 9 5.9 9 7S8.1 9 7 9 5 8.1 5 7 5.9 5 7 5M12 8C15.3 8 18 10.7 18 14C18 17.3 15.3 20 12 20S6 17.3 6 14C6 10.7 8.7 8 12 8Z"/></svg>'); }
.st-star { width: 30px; height: 30px; background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="%23ffd700"><path d="M12 2L15.09 8.26L22 9.27L17 14.14L18.18 21.02L12 17.77L5.82 21.02L7 14.14L2 9.27L8.91 8.26L12 2Z"/></svg>'); }
.st-heart { background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="%23ff6b6b"><path d="M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z"/></svg>'); }

.label-sticker {
  position: absolute;
  padding: 6px 16px;
  background: #e74c3c;
  color: #fff;
  font-weight: 700;
  font-size: 20px;
  border-radius: 2px;
  border: 2px solid #fff;
  box-shadow: 0 2px 4px rgba(0,0,0,.2);
  pointer-events: none;
}

.list { list-style: disc; padding-left: 20px; }
.stats div { display: flex; justify-content: space-between; margin-bottom: 6px; }
.status { margin-top: 12px; border: 1px solid #dc2626; color: #dc2626; text-align: center; font-size: 11px; padding: 4px; transform: rotate(-6deg); font-weight: 700; }

.receipt { background: #fff; font-family: monospace; box-shadow: 0 1px 3px rgba(0,0,0,.12); border-top: 1px dashed #ccc; border-bottom: 1px dashed #ccc; }
.receipt-items { margin: 12px 0; }
.receipt-items div { display: flex; justify-content: space-between; margin-bottom: 4px; }
.divider { border-top: 1px dashed #000; margin: 8px 0; }

.graph { background-color: #fff; background-image: linear-gradient(#e5e7eb 1px, transparent 1px), linear-gradient(90deg, #e5e7eb 1px, transparent 1px); background-size: 20px 20px; }

.ticket { background: #ffadad; border-radius: 4px; }
.ticket-inner { display: flex; align-items: center; justify-content: center; height: 100%; border: 2px dashed rgba(139,0,0,.2); margin: 4px; color: #8b0000; letter-spacing: 2px; }

.player { display: flex; flex-direction: column; justify-content: center; height: 100%; padding: 0 8px; }
.bar { width: 100%; height: 4px; background: #444; border-radius: 2px; margin-bottom: 8px; }
.fill { height: 100%; width: 33%; background: #4ade80; }
.controls { margin-top: 8px; font-size: 18px; }

.palette { display: flex; justify-content: center; gap: 8px; margin-top: 12px; }
.palette div { width: 32px; height: 32px; border-radius: 50%; }

.swatch { height: 100%; display: flex; flex-direction: column; }
.swatch > div { flex: 1; }
.swatch .label { height: 28px; background: #fff; display: flex; align-items: center; justify-content: center; }

.face { display: flex; align-items: center; justify-content: center; height: 100%; }

.map { background: #f4e4bc; }
.map-inner { width: 100%; height: 80%; border: 2px solid rgba(139,69,19,.3); opacity: .5; display: flex; align-items: center; justify-content: center; }
.map-inner svg { width: 100%; height: 100%; padding: 16px; }
.map-label { position: absolute; bottom: 8px; right: 16px; color: #8b4513; }

.postcard { background: #e3f2fd; }
.stamp { position: absolute; top: 8px; right: 8px; width: 48px; height: 60px; border: 1px solid #999; background: #fff; }
.postcard-text { margin-top: 40px; margin-left: 16px; color: #1e40af; font-size: 18px; }

.code { padding: 8px; word-break: break-all; }

.env-inner { width: 100%; height: 100%; border: 1px solid #e5e5e5; display: flex; align-items: center; justify-content: center; position: relative; overflow: hidden; background: #f5f5f5; }
.env-flap { position: absolute; top: 0; left: 0; right: 0; height: 50%; background: #fff; clip-path: polygon(0 0, 50% 100%, 100% 0); }

.placeholder { margin-top: 8px; width: 100%; height: 80px; border: 2px dashed #ccc; border-radius: 4px; display: flex; align-items: center; justify-content: center; }

.overlay {
  position: fixed;
  inset: 0;
  display: flex;
  align-items: center;
  justify-content: center;
  background: rgba(0,0,0,.6);
  opacity: 0;
  pointer-events: none;
  transition: opacity .15s;
  z-index: 200;
}

.overlay.show { opacity: 1; pointer-events: auto; }

.overlay-card {
  background: #fffaf0;
  padding: 32px;
  border-radius: 8px;
  width: 90vw;
  max-width: 400px;
  box-shadow: 0 20px 40px rgba(0,0,0,.4);
  position: relative;
}

.close-hint { position: absolute; top: 12px; right: 16px; font-size: 11px; color: #999; }
.overlay-title { font-size: 18px; font-weight: 700; color: #78350f; }
.overlay-body { margin-top: 12px; font-size: 15px; color: #451a03; line-height: 1.5; }